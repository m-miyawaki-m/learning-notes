保守や調査のために使用されるSQLクエリは、システムの状態を確認したり、パフォーマンスの問題を診断したりする際に重要です。これらのクエリは、データベースの健全性、パフォーマンス、セキュリティなどの様々な側面を確認するために利用されます。以下に、よく使われるいくつかのSQLクエリの例を挙げます。

### 1. テーブルの構造を確認する
データベース内の特定のテーブルの構造を表示するために使用されます。
```sql
DESCRIBE テーブル名;
```

### 2. データベースのスペース使用量を確認する
テーブルやインデックスがどれだけのスペースを使用しているかを確認します。
```sql
SELECT segment_name, segment_type, bytes/1024/1024 MB FROM dba_segments WHERE owner = 'スキーマ名';
```

### 3. スロークエリのログを確認する
実行に時間がかかったクエリを特定します。
```sql
SELECT * FROM v$sql WHERE elapsed_time > 1000000 ORDER BY elapsed_time DESC;
```

### 4. デッドロックの検出
デッドロックを引き起こすトランザクションを特定します。
```sql
SELECT * FROM dba_blockers;
```

### 5. テーブルの行数を確認する
特定のテーブルの行数をカウントします。
```sql
SELECT COUNT(*) FROM テーブル名;
```

### 6. インデックスの利用状況を確認する
インデックスがどの程度利用されているかを確認します。
```sql
SELECT * FROM v$index_usage_info WHERE name = 'インデックス名';
```

### 7. ユーザー権限の確認
特定のユーザーに与えられた権限を確認します。
```sql
SELECT * FROM dba_sys_privs WHERE grantee = 'ユーザー名';
```

これらのクエリは一例ですが、実際には保守や調査のニーズに合わせてカスタマイズされることが多いです。また、使用するデータベースの種類（Oracle, MySQL, SQL Serverなど）によって、利用可能なクエリやビューが異なることに注意が必要です。



---
## v$sqlビューについて
`v$sql` は、Oracleデータベースのダイナミックパフォーマンスビューの一つです。このビューは、データベースによって解析されたSQLステートメントの情報を提供します。具体的には、実行されたSQLクエリのテキスト、実行計画、実行回数、実行時間、使用されたリソースなどの詳細なメトリクスを含んでいます。

### v$sqlの主な用途
- **パフォーマンス分析**：データベースのパフォーマンス問題を診断する際に役立ちます。たとえば、最もリソースを消費するクエリや、最も頻繁に実行されるクエリを特定するのに使用できます。
- **SQLチューニング**：特定のクエリの実行計画を分析し、最適化のためのヒントや改善点を見つけ出すのに役立ちます。
- **監査とセキュリティ**：どのようなSQL文が実行されたかを追跡することで、セキュリティ監査やデータベースの使用状況の分析にも使用できます。

### v$sqlビューの構造
`v$sql` ビューには多くのカラムが含まれており、以下はその一部の例です：

- `SQL_TEXT`：実行されたSQLステートメントのテキスト。
- `EXECUTIONS`：クエリが実行された回数。
- `ELAPSED_TIME`：クエリの総実行時間。
- `CPU_TIME`：クエリのCPU使用時間。
- `DISK_READS`：クエリ実行時のディスク読み込み回数。
- `ROWS_PROCESSED`：クエリによって処理された行の数。

### 注意点
- `v$sql` は、データベースのパフォーマンスに関する重要な情報を含んでいますが、これを閲覧できるのはデータベース管理者や適切な権限を持ったユーザーに限られます。
- このビューの情報はメモリに格納されており、データベースが再起動すると情報はリセットされます。永続的な監視が必要な場合は、別の方法を検討する必要があります。